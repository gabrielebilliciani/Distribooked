{"openapi":"3.1.0","info":{"title":"Distribooked API","description":"API documentation for 'Distribooked'","version":"1.0.0"},"servers":[{"url":"http://localhost:8080","description":"Generated server url"}],"security":[{"bearerAuth":[]}],"tags":[{"name":"Loans","description":"Operations related to loans, for admins only."},{"name":"Usage statistics","description":"Operations related to statistics, for admins only."},{"name":"Library-related searches","description":"Endpoints available to everyone, without authentication."},{"name":"Catalogue Management","description":"Operations related to catalogue management, for admins only."},{"name":"Author-related searches","description":"Endpoints available to everyone, without authentication."},{"name":"Reservations","description":"Operations related to book reservations, for registered users."},{"name":"Book-related searches","description":"Endpoints available to everyone, without authentication."},{"name":"User","description":"Operations related to users, for registered users."},{"name":"Authentication","description":"Operations users/admins authentication."}],"paths":{"/api/v1/reservations/save":{"post":{"tags":["Reservations"],"summary":"Save a book","description":"Allows a user to save a book for a maximum of 50.","operationId":"saveBook","parameters":[{"name":"bookId","in":"query","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Book saved successfully.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/SuccessResponse"},"example":{"data":{"savedBook":{"id":"679cb34ab477993c5cdd4f0f","title":"Triplanetary","authors":[{"id":"679cb31ab477993c5cdc1bc7","fullName":"E. E. (Edward Elmer) Smith"}]}},"message":"Book saved successfully.","timestamp":"2025-02-09T17:14:28.0451107","status":200}}}},"404":{"description":"Book not found.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"Book limit exceeded.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"Please login to access this resource.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Insufficient privileges to access this resource.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}},"security":[{"bearerAuth":[]}]}},"/api/v1/reservations/reserve":{"post":{"tags":["Reservations"],"summary":"Reserve a book","description":"Allows a user to reserve a book in a specific library.","operationId":"reserveBook","parameters":[{"name":"bookId","in":"query","required":true,"schema":{"type":"string"}},{"name":"libraryId","in":"query","required":true,"schema":{"type":"string"}}],"responses":{"400":{"description":"Invalid reservation details or max reservations reached.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"201":{"description":"Book reserved successfully.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/CreatedResponse"},"example":{"path":"/api/v1/reservations/reserve","data":{"reservation":{"userId":"67a5269e68b78d7479d391a6","bookId":"679cb34ab477993c5cdd4f0f","libraryId":"679cb364d125ba32463b9759","reservedAt":"2025-02-09T16:11:37.092","expiresAt":"2025-02-09T16:15:56.292"}},"message":"Book reserved successfully.","timestamp":"2025-02-09T17:11:37.1561781","status":201}}}},"404":{"description":"Book or library not found.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"409":{"description":"Reservation conflict.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"Please login to access this resource.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Insufficient privileges to access this resource.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}},"security":[{"bearerAuth":[]}]}},"/api/v1/auth/register":{"post":{"tags":["Authentication"],"summary":"Register a new user","description":"Creates a new user account with the specified details.","operationId":"register","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RegistrationRequestDTO"}}},"required":true},"responses":{"201":{"description":"User registered successfully","content":{"*/*":{"schema":{"$ref":"#/components/schemas/CreatedResponse"},"example":{"timestamp":"2025-01-31T12:00:00.000Z","status":201,"message":"User registered successfully","data":{"id":"889a770c426571df71448d64","username":"johndoe"},"path":"/api/v1/auth/register"}}}},"400":{"description":"Invalid registration details","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"409":{"description":"User already exists","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/v1/auth/logout":{"post":{"tags":["Authentication"],"summary":"Log out a user","description":"Logs out the currently authenticated user.","operationId":"logout","responses":{"403":{"description":"Invalid or expired token.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"Logout failed","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"Logout successful","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}},"401":{"description":"Please login to access this resource.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}},"security":[{"bearerAuth":[]}]}},"/api/v1/auth/login":{"post":{"tags":["Authentication"],"summary":"Log in a user","description":"Authenticates a user and returns JWT tokens.","operationId":"login","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginRequestDTO"}}},"required":true},"responses":{"401":{"description":"Invalid credentials","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"Invalid input data","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"Login successful","content":{"*/*":{"schema":{"$ref":"#/components/schemas/SuccessResponse"},"example":{"data":{"token":"eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJqb2huX2RvZSIsImV4cCI6MTczOTEyMDUyMSwidXNlcl9pZCI6IjY3YTUyNjllNjhiNzhkNzQ3OWQzOTFhNiIsImlhdCI6MTczOTExNjkyMSwicm9sZXMiOlsiVVNFUiJdfQ.E4kui5Mwzyrd7_WNTrxWb0z8i6_rqXFsINEXnzTXyqM"},"message":"Login successful","timestamp":"2025-02-09T17:02:01.888945","status":200}}}},"500":{"description":"Internal server error","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/v1/admin/loans/{libraryId}/{userId}/{bookId}/mark-as-loan":{"post":{"tags":["Loans"],"summary":"(ADMIN) Mark reservation as a loan","description":"Converts a reservation into a loan when the user picks up the reserved book.","operationId":"markAsLoan","parameters":[{"name":"libraryId","in":"path","required":true,"schema":{"type":"string"}},{"name":"userId","in":"path","required":true,"schema":{"type":"string"}},{"name":"bookId","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"401":{"description":"Unauthorized access.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Forbidden – insufficient permissions.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Reservation not found.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"Reservation successfully marked as loan.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/SuccessResponse"}}}},"400":{"description":"Invalid request data.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}},"security":[{"bearerAuth":[]}]}},"/api/v1/admin/loans/{libraryId}/{userId}/{bookId}/complete":{"post":{"tags":["Loans"],"summary":"(ADMIN) Complete a loan","description":"Marks a loan as completed when a user returns a borrowed book, increasing availability.","operationId":"completeLoan","parameters":[{"name":"libraryId","in":"path","required":true,"schema":{"type":"string"}},{"name":"userId","in":"path","required":true,"schema":{"type":"string"}},{"name":"bookId","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"404":{"description":"Loan not found.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"Unauthorized access.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Forbidden – insufficient permissions.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"Loan completed successfully.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/SuccessResponse"}}}},"400":{"description":"Invalid request data.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}},"security":[{"bearerAuth":[]}]}},"/api/v1/admin/catalogue/libraries":{"post":{"tags":["Catalogue Management"],"summary":"(ADMIN) Add a new library","description":"Allows an admin to add a new library to the collection. A library must have a unique combination of name and postal code.","operationId":"addLibrary","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LibraryDTO"}}},"required":true},"responses":{"409":{"description":"A library with the same name and postal code already exists.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"201":{"description":"Library added successfully.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/CreatedResponse"},"example":"{\n  \"path\": \"/api/v1/admin/catalogue/libraries/64b87f1a2d3b9c1234567890\",\n  \"data\": {\n    \"id\": \"64b87f1a2d3b9c1234567890\",\n    \"name\": \"Biblioteca degli Universitari Toscani\",\n    \"address\": {\n      \"street\": \"Via Roma, 10\",\n      \"city\": \"Firenze\",\n      \"province\": \"FI\",\n      \"postalCode\": \"50123\",\n      \"country\": \"Italy\"\n    },\n    \"postalCode\": \"12345\",\n    \"province\": \"Province A\",\n    \"region\": \"Region B\",\n    \"provinceIstatCode\": \"654321\",\n    \"latitude\": 43.7942,\n    \"longitude\": 11.2468\",\n    \"phone\": \"123-456-7890\",\n    \"email\": \"info@library.com\",\n    \"url\": \"http://library.com\"\n  },\n  \"message\": \"Library added successfully\",\n  \"timestamp\": \"2025-02-09T18:12:33.8579964\",\n  \"status\": 201\n}\n"}}},"400":{"description":"Invalid library details.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"Please login to access this resource.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Insufficient privileges to access this resource.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}},"security":[{"bearerAuth":[]}]}},"/api/v1/admin/catalogue/books":{"post":{"tags":["Catalogue Management"],"summary":"(ADMIN) Add a book to the catalog","description":"Allows an admin to add a new book to the catalog.\nThis endpoint is reserved for administrators.\nThe new book must not include the `branches` field, as libraries stocking the book should be added separately.\nAdditionally, all authors referenced in the request must already exist in the `authors` collection.\n","operationId":"addBook","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BookDTO"}}},"required":true},"responses":{"400":{"description":"Invalid book details","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"409":{"description":"Book already exists","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"Please login to access this resource.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"201":{"description":"Book added successfully","content":{"*/*":{"schema":{"$ref":"#/components/schemas/CreatedResponse"},"example":{"path":"/api/v1/admin/catalogue/books/67a8de6e0ffe182e3ab5ea2c","data":{"id":"67a8de6e0ffe182e3ab5ea2c","title":"The Revolutionary Ideas of Thomas Jefferson (II print)","subtitle":"A Perspective on Liberty","publicationDate":"2023-01-01","language":"English","categories":["History","Biography","Politics"],"isbn10":"1234567890","isbn13":"9781234567890","publisher":"Freedom Press","coverImageUrl":"https://example.com/cover.jpg","authors":[{"id":"679cb31ab477993c5cdbf61a","fullName":"Thomas Jefferson"}],"readingsCount":0},"message":"Book added successfully","timestamp":"2025-02-09T17:57:18.6232808","status":201}}}},"403":{"description":"Insufficient privileges to access this resource.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}},"security":[{"bearerAuth":[]}]}},"/api/v1/admin/catalogue/books/{bookId}/libraries/{libraryId}":{"post":{"tags":["Catalogue Management"],"summary":"(ADMIN) Add a library to a book's availability","description":"Allows an admin to add a library to the availability of a book.","operationId":"addLibraryToBookAvailability","parameters":[{"name":"bookId","in":"path","required":true,"schema":{"type":"string"}},{"name":"libraryId","in":"path","required":true,"schema":{"type":"string"}},{"name":"initialValue","in":"query","required":false,"schema":{"type":"integer","format":"int32"}}],"responses":{"404":{"description":"Book or library not found.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"Invalid request","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"Library added to book availability successfully","content":{"*/*":{"schema":{"$ref":"#/components/schemas/SuccessResponse"}}}},"500":{"description":"Internal server error.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"Please login to access this resource.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Insufficient privileges to access this resource.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}},"security":[{"bearerAuth":[]}]},"delete":{"tags":["Catalogue Management"],"summary":"(ADMIN) Remove a book from a library","description":"Allows an admin to completely remove a book from a specific library.","operationId":"removeBookFromLibrary","parameters":[{"name":"bookId","in":"path","required":true,"schema":{"type":"string"}},{"name":"libraryId","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"404":{"description":"Book or library not found.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"Book removed from library successfully","content":{"*/*":{"schema":{"$ref":"#/components/schemas/SuccessResponse"}}}},"400":{"description":"Invalid request","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"Please login to access this resource.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Insufficient privileges to access this resource.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}},"security":[{"bearerAuth":[]}]}},"/api/v1/admin/catalogue/books/{bookId}/libraries/{libraryId}/increment":{"patch":{"tags":["Catalogue Management"],"summary":"(ADMIN) Increment available copies of a book in a library","description":"Allows an admin to increment the number of available copies of a book in a specific library.","operationId":"incrementAvailableCopies","parameters":[{"name":"bookId","in":"path","required":true,"schema":{"type":"string"}},{"name":"libraryId","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Copies incremented successfully","content":{"*/*":{"schema":{"$ref":"#/components/schemas/SuccessResponse"}}}},"404":{"description":"Book or library not found.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"Invalid request","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"Please login to access this resource.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Insufficient privileges to access this resource.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}},"security":[{"bearerAuth":[]}]}},"/api/v1/admin/catalogue/books/{bookId}/libraries/{libraryId}/decrement":{"patch":{"tags":["Catalogue Management"],"summary":"(ADMIN) Decrement available copies of a book in a library","description":"Allows an admin to decrement the number of available copies of a book in a specific library.","operationId":"decrementAvailableCopies","parameters":[{"name":"bookId","in":"path","required":true,"schema":{"type":"string"}},{"name":"libraryId","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"404":{"description":"Book or library not found.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"Copies decremented successfully","content":{"*/*":{"schema":{"$ref":"#/components/schemas/SuccessResponse"}}}},"400":{"description":"Invalid request or no available copies.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"Please login to access this resource.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Insufficient privileges to access this resource.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}},"security":[{"bearerAuth":[]}]}},"/api/v1/users/saved":{"get":{"tags":["User"],"summary":"Get saved books","description":"Returns the list of books saved by the current user.","operationId":"getSavedBooks","responses":{"200":{"description":"Successfully retrieved saved books.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/SuccessResponse"},"example":{"data":{"savedBooks":[{"id":"679cb34ab477993c5cdd4f0f","title":"Triplanetary","authors":[{"id":"679cb31ab477993c5cdc1bc7","fullName":"E. E. (Edward Elmer) Smith"}]}]},"message":"Saved books retrieved successfully.","timestamp":"2025-02-09T17:15:59.9241197","status":200}}}},"404":{"description":"User not found.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"Please login to access this resource.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Insufficient privileges to access this resource.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}},"security":[{"bearerAuth":[]}]}},"/api/v1/users/reserved-loaned":{"get":{"tags":["User"],"summary":"Get reserved and loaned books","description":"Returns the list of books currently reserved or loaned by the user.","operationId":"getReservedAndLoanedBooks","responses":{"200":{"description":"Successfully retrieved reserved and loaned books.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/SuccessResponse"},"example":{"data":{"reservedAndLoanedBooks":[{"bookId":"679cb34ab477993c5cdd4f0f","libraryId":"679cb364d125ba32463b9759","libraryName":"Biblioteca di Scienze naturali e ambientali dell'Università di Pisa","title":"Triplanetary","status":"RESERVED","deadlineDate":1739376697092}]},"message":"Reserved and loaned books retrieved successfully.","timestamp":"2025-02-09T17:12:57.9786811","status":200}}}},"500":{"description":"Internal server error.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"Please login to access this resource.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Insufficient privileges to access this resource.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}},"security":[{"bearerAuth":[]}]}},"/api/v1/users/read":{"get":{"tags":["User"],"summary":"Get read books","description":"Returns the list of books read by the current user.","operationId":"getReadBooks","responses":{"200":{"description":"Successfully retrieved read books.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/SuccessResponse"},"example":"{\n  \"data\": {\n    \"readBooks\": [\n      {\n        \"id\": \"679cb33db477993c5cdcdf9c\",\n        \"title\": \"Der Tod in Venedig\",\n        \"authors\": [\n          {\n            \"id\": \"679cb31ab477993c5cdc08da\",\n            \"fullName\": \"Thomas Mann\"\n          }\n        ],\n        \"libraryId\": \"679cb364d125ba32463b9746\",\n        \"returnDate\": \"2025-02-09T16:55:26\"\n      },\n      ...\n    ]\n  },\n  \"message\": \"Read books retrieved successfully.\",\n  \"timestamp\": \"2025-02-09T17:58:55.1401252\",\n  \"status\": 200\n}\n"}}},"404":{"description":"User not found.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"Please login to access this resource.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Insufficient privileges to access this resource.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}},"security":[{"bearerAuth":[]}]}},"/api/v1/users/details":{"get":{"tags":["User"],"summary":"Get user details","description":"Returns the personal details of the current user.","operationId":"getUserDetails","responses":{"200":{"description":"Successfully retrieved user details.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/SuccessResponse"},"example":{"data":{"userDetails":{"id":"67a5269e68b78d7479d391a6","username":"john_doe","name":"John","surname":"Doe","dateOfBirth":"1990-01-01","email":"john.doe@example.com","address":{"street":"Via Roma, 10","city":"Firenze","province":"FI","postalCode":"50123","country":"Italy"}}},"message":"User details retrieved successfully.","timestamp":"2025-02-09T17:25:44.573562","status":200}}}},"404":{"description":"User not found.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"Please login to access this resource.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Insufficient privileges to access this resource.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}},"security":[{"bearerAuth":[]}]}},"/api/v1/libraries/{id}":{"get":{"tags":["Library-related searches"],"summary":"Get library details","description":"Retrieve details of a specific library by its ID. Returns 404 if the library does not exist.","operationId":"getLibraryById","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"404":{"description":"Library not found","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"Library details retrieved successfully","content":{"*/*":{"schema":{"$ref":"#/components/schemas/SuccessResponse"},"example":{"data":{"id":"679cb364d125ba32463b9746","name":"Biblioteca dell'Istituto Domus Mazziniana","address":{"street":"Via Giuseppe Mazzini 71","city":"Pisa","province":"Pisa","postalCode":"56125","country":"Italia"},"latitude":43.7114097,"longitude":10.3980345,"phone":"+39 05024174","email":"info@domusmazziniana.it","url":"www.domusmazziniana.it"},"message":"Library details retrieved successfully","timestamp":"2025-02-09T17:37:37.673684","status":200}}}},"500":{"description":"Internal server error","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/v1/books":{"get":{"tags":["Book-related searches"],"summary":"Browse book catalog","description":"Retrieve a paginated list of books in the catalog.","operationId":"getBooks","parameters":[{"name":"page","in":"query","description":"Page number to retrieve. Defaults to 0 (first page).","required":false,"schema":{"type":"integer","format":"int32","default":0},"example":0},{"name":"size","in":"query","description":"Number of books per page. Must be between 1 and 100.","required":false,"schema":{"type":"integer","format":"int32","default":20,"maximum":100},"example":20}],"responses":{"413":{"description":"Requested page size is too large","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"Books retrieved successfully","content":{"*/*":{"schema":{"$ref":"#/components/schemas/SuccessResponse"},"example":"{\n  \"data\": {\n    \"content\": [\n      {\n        \"id\": \"679cb334b477993c5cdc8b3d\",\n        \"title\": \"Alice's Adventures in Wonderland\",\n        \"subtitle\": \"Hardcover – January 1, 1997\",\n        \"authors\": [\n          {\n            \"id\": \"679cb31ab477993c5cdbf61f\",\n            \"fullName\": \"Lewis Carroll\"\n          }\n        ],\n        \"categories\": [\n          \"Books\",\n          \"Children's Books\",\n          \"Classics\"\n        ],\n        \"coverImageUrl\": \"https://m.media-amazon.com/images/I/41SJd51ySkL._SX218_BO1,204,203,200_QL40_FMwebp_.jpg\"\n      },\n      ...\n    ],\n    \"page\": {\n      \"size\": 20,\n      \"number\": 0,\n      \"totalElements\": 100866,\n      \"totalPages\": 5044\n    }\n  },\n  \"message\": \"Books retrieved successfully\",\n  \"timestamp\": \"2025-02-09T17:21:30.3806508\",\n  \"status\": 200\n}\n"}}},"400":{"description":"Invalid request parameters","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/v1/books/{id}":{"get":{"tags":["Book-related searches"],"summary":"Get book details with optional library proximity search","description":"Retrieve details of a specific book by its ID. If latitude and longitude are provided, the response will include only libraries near that location. An optional radius (in meters) can be specified for filtering libraries within that range; otherwise, a default of 50km is applied.","operationId":"getBookByIdWithLibraries","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"string"}},{"name":"latitude","in":"query","required":false,"schema":{"type":"number","format":"double"}},{"name":"longitude","in":"query","required":false,"schema":{"type":"number","format":"double"}},{"name":"radius","in":"query","required":false,"schema":{"type":"integer","format":"int32"}}],"responses":{"404":{"description":"Book not found","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"Book details retrieved successfully","content":{"*/*":{"schema":{"$ref":"#/components/schemas/SuccessResponse"},"example":{"data":{"id":"679cb34ab477993c5cdd4f0f","title":"Triplanetary","subtitle":"Mass Market Paperback – January 1, 1973","publicationDate":"2010-06-06","language":"English","categories":["Books","Science Fiction & Fantasy","Science Fiction"],"isbn10":"0515028908","isbn13":"978-0515028904","publisher":"Pyramid (January 1, 1973)","coverImageUrl":null,"authors":[{"id":"679cb31ab477993c5cdc1bc7","fullName":"E. E. (Edward Elmer) Smith"}],"branches":[{"id":"679cb364d125ba32463b9759","libraryName":"Biblioteca di Scienze naturali e ambientali dell'Università di Pisa","coordinates":[10.3953125,43.7185718],"address":"Via Derna 1, Pisa, Pisa 56126, Italia","numberOfCopies":2},{"id":"679cb364d125ba32463b9749","libraryName":"Biblioteca di Ingegneria dell'Università di Pisa","coordinates":[10.3896690589,43.7207286212],"address":"Largo Lucio Lazzarino 1, Pisa, Pisa 56122, Italia","numberOfCopies":5},{"id":"679cb364d125ba32463b974e","libraryName":"Biblioteca di Antichistica, Linguistica, Germanistica, Slavistica dell'Università di Pisa","coordinates":[10.3974391,43.7195217],"address":"Via Santa Maria 44, Pisa, Pisa 56126, Italia","numberOfCopies":3},{"id":"679cb364d125ba32463b974f","libraryName":"Biblioteca di italianistica e romanistica dell'Università di Pisa","coordinates":[10.3981386135,43.7182307403],"address":"Piazza Torricelli 2, Pisa, Pisa 56126, Italia","numberOfCopies":5}],"readingsCount":5},"message":"Book details retrieved successfully","timestamp":"2025-02-09T17:06:55.3797938","status":200}}}},"400":{"description":"Invalid input for coordinates or radius","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/v1/books/{bookId}/availability/{libraryId}":{"get":{"tags":["Book-related searches"],"summary":"Check book availability in a specific library","description":"Retrieve the real availability of a specific book in a specific library.","operationId":"getBookAvailability","parameters":[{"name":"bookId","in":"path","required":true,"schema":{"type":"string"}},{"name":"libraryId","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Availability retrieved successfully","content":{"*/*":{"schema":{"$ref":"#/components/schemas/SuccessResponse"},"example":{"data":5,"message":"Availability retrieved successfully","timestamp":"2025-02-09T17:24:31.0175692","status":200}}}},"404":{"description":"Book or library not found","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/v1/books/search":{"get":{"tags":["Book-related searches"],"summary":"Search books","description":"Search books by title (exact match) and optionally by author (allows partial matches on title if author's name matches).","operationId":"searchBooks","parameters":[{"name":"title","in":"query","description":"Filter by book title. This parameter is mandatory. Requires an exact match if no author is specified.","required":true,"schema":{"type":"string"},"example":"Effective Java"},{"name":"author","in":"query","description":"Filter by author name. This parameter is optional. Enables a more flexible search for partial titles.","required":false,"schema":{"type":"string"},"example":"Joshua Bloch"},{"name":"page","in":"query","required":false,"schema":{"type":"integer","format":"int32","default":0}}],"responses":{"404":{"description":"No books found matching the specified criteria","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"Invalid request parameters","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"Books retrieved successfully","content":{"*/*":{"schema":{"$ref":"#/components/schemas/SuccessResponse"},"example":{"data":{"totalItems":1,"books":[{"id":"679cb33db477993c5cdcdf9c","title":"Der Tod in Venedig","subtitle":null,"authors":[{"id":"679cb31ab477993c5cdc08da","fullName":"Thomas Mann"}],"categories":null,"coverImageUrl":null}],"totalPages":1,"currentPage":0},"message":"Books retrieved successfully","timestamp":"2025-02-09T17:22:58.8306423","status":200}}}}}}},"/api/v1/books/filter":{"get":{"tags":["Book-related searches"],"summary":"Filter books","description":"Retrieve books filtered by category and/or sorted by popularity.","operationId":"filterBooks","parameters":[{"name":"category","in":"query","description":"Filter by book category","required":false,"schema":{"type":"string"},"example":"Science Fiction"},{"name":"sortByPopularity","in":"query","description":"Sort by popularity","required":false,"schema":{"type":"boolean"},"example":true},{"name":"page","in":"query","description":"Page number to retrieve","required":false,"schema":{"type":"integer","format":"int32","default":0},"example":0},{"name":"size","in":"query","description":"Number of books per page (max 100)","required":false,"schema":{"type":"integer","format":"int32","default":20,"maximum":100},"example":20}],"responses":{"200":{"description":"Books filtered successfully","content":{"*/*":{"schema":{"$ref":"#/components/schemas/SuccessResponse"},"example":"{\n  \"data\": {\n    \"content\": [\n      {\n        \"id\": \"679cb339b477993c5cdcbf94\",\n        \"title\": \"The Time Machine\",\n        \"subtitle\": \"Paperback – March 21, 2014\",\n        \"authors\": [\n          {\n            \"id\": \"679cb31ab477993c5cdbf638\",\n            \"fullName\": \"H. G. (Herbert George) Wells\"\n          }\n        ],\n        \"categories\": [\n          \"Books\",\n          \"Science Fiction & Fantasy\",\n          \"Science Fiction\"\n        ],\n        \"coverImageUrl\": null\n      },\n      {\n        \"id\": \"679cb34ab477993c5cdd4f0f\",\n        \"title\": \"Triplanetary\",\n        \"subtitle\": \"Mass Market Paperback – January 1, 1973\",\n        \"authors\": [\n          {\n            \"id\": \"679cb31ab477993c5cdc1bc7\",\n            \"fullName\": \"E. E. (Edward Elmer) Smith\"\n          }\n        ],\n        \"categories\": [\n          \"Books\",\n          \"Science Fiction & Fantasy\",\n          \"Science Fiction\"\n        ],\n        \"coverImageUrl\": null\n      },\n      ...\n    ],\n    \"page\": {\n      \"size\": 20,\n      \"number\": 0,\n      \"totalElements\": 659,\n      \"totalPages\": 33\n    }\n  },\n  \"message\": \"Books filtered successfully\",\n  \"timestamp\": \"2025-02-09T17:06:34.1979988\",\n  \"status\": 200\n}"}}},"400":{"description":"Invalid request parameters","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/v1/authors/{authorId}":{"get":{"tags":["Author-related searches"],"summary":"Get author details","description":"    Retrieve detailed information about an author by their ID, including their biography\n    and a paginated list of books. If the author has more than 20 books, the response will\n    include only the first 20 books, additional books can be fetched using the\n    `/authors/{authorId}/books` endpoint.\n","operationId":"getAuthorDetails","parameters":[{"name":"authorId","in":"path","description":"The ID of the author.","required":true,"schema":{"type":"string"}}],"responses":{"404":{"description":"Author not found","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"Author details retrieved successfully","content":{"*/*":{"schema":{"$ref":"#/components/schemas/SuccessResponse"},"example":"{\n  \"data\": {\n    \"author\": {\n      \"id\": \"679cb31ab477993c5cdc08da\",\n      \"fullName\": \"Thomas Mann\",\n      \"yearOfBirth\": \"1875\",\n      \"yearOfDeath\": \"1955\",\n      \"avatarUrl\": \"https://m.media-amazon.com/images/I/91bDRRiA2fL._SY600_.jpg\",\n      \"about\": \"Thomas Mann (1875–1955) was a German novelist and Nobel laureate, known for his psychological and symbolic narratives...\",\n      \"books\": [\n        {\n          \"id\": \"679cb34cb477993c5cdd5e5c\",\n          \"title\": \"Royal Highness\",\n          \"subtitle\": \"Paperback – January 27, 2019\",\n          \"authors\": [\n            {\n              \"id\": null,\n              \"fullName\": \"Thomas Mann\"\n            },\n            {\n              \"id\": null,\n              \"fullName\": \"Curtis A. Cecil [Translator]\"\n            }\n          ],\n          \"categories\": [\n            \"Books\",\n            \"Literature & Fiction\",\n            \"Literary\"\n          ],\n          \"coverImageUrl\": \"https://m.media-amazon.com/images/I/51NSftca6AL._SX348_BO1,204,203,200_.jpg\"\n        },\n        ...\n      ]\n    }\n  },\n  \"message\": \"Author details retrieved successfully\",\n  \"timestamp\": \"2025-02-09T17:28:56.8133314\",\n  \"status\": 200\n}\n"}}},"400":{"description":"Invalid author ID format","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/v1/authors/{authorId}/books":{"get":{"tags":["Author-related searches"],"summary":"Get paginated books","description":"    Retrieve paginated books for an author. This endpoint is typically used after calling\n    `/authors/{authorId}`, to retrieve more than the first 20 books.\n    Use the `page` parameter to specify which set of books to retrieve\n    (e.g., `page=0` for books 1–20, `page=1` for books 21–40, etc.) - default is 1, because the first\n    20 books are returned together with the author in `/authors/{authorId}`.\n","operationId":"getAuthorBooks","parameters":[{"name":"authorId","in":"path","description":"The ID of the author.","required":true,"schema":{"type":"string"}},{"name":"page","in":"query","description":"The page number (0-based).","required":true,"schema":{"type":"integer","format":"int32","default":1}}],"responses":{"404":{"description":"Author not found","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"Invalid author ID or page number","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"Books retrieved successfully","content":{"*/*":{"schema":{"$ref":"#/components/schemas/SuccessResponse"},"example":"{\n  \"data\": {\n    \"books\": [\n      {\n        \"id\": \"679cb360b477993c5cddf873\",\n        \"title\": \"Buddenbrookit 1: Erään suvun rappeutumistarina\",\n        \"subtitle\": null,\n        \"authors\": [\n          {\n            \"id\": null,\n            \"fullName\": \"Thomas Mann\"\n          },\n          {\n            \"id\": null,\n            \"fullName\": \"Siegberg Siiri 1890-1940 [Translator]\"\n          }\n        ],\n        \"categories\": null,\n        \"coverImageUrl\": null\n      },\n      ...\n    ],\n    \"page\": 1\n  },\n  \"message\": \"Books retrieved successfully\",\n  \"timestamp\": \"2025-02-09T17:30:28.2470955\",\n  \"status\": 200\n}\n"}}},"500":{"description":"Internal server error","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/v1/authors/search":{"get":{"tags":["Author-related searches"],"summary":"Search authors","description":"Search authors by their full name.","operationId":"searchAuthors","parameters":[{"name":"fullName","in":"query","description":"Filter by the full name of the author. This parameter is mandatory.","required":true,"schema":{"type":"string"},"example":"Joshua Bloch"}],"responses":{"200":{"description":"Authors retrieved successfully","content":{"*/*":{"schema":{"$ref":"#/components/schemas/SuccessResponse"},"example":{"data":{"authors":[{"id":"679cb31ab477993c5cdc08da","fullName":"Thomas Mann","yearOfBirth":"1875","yearOfDeath":"1955"}]},"message":"Authors retrieved successfully","timestamp":"2025-02-09T17:27:31.4419328","status":200}}}},"400":{"description":"Invalid input parameter","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"No authors found with the given name","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/v1/admin/statistics/most-read-by-age":{"get":{"tags":["Usage statistics"],"summary":"(ADMIN) Get most read books by age group in a time interval","description":"Retrieves the most read books by different age groups within a specified time interval.","operationId":"getMostReadBooksByAgeGroup","parameters":[{"name":"startDate","in":"query","description":"Start date (YYYY-MM-DD)","required":true,"schema":{"type":"string"}},{"name":"endDate","in":"query","description":"End date (YYYY-MM-DD)","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Statistics retrieved successfully","content":{"*/*":{"schema":{"$ref":"#/components/schemas/SuccessResponse"},"example":"{\n  \"data\": [\n    {\n      \"ageGroup\": \"50+\",\n      \"totalReadings\": 3967,\n      \"mostReadBooks\": [\n        {\n          \"bookId\": \"679cb35fb477993c5cddede2\",\n          \"bookTitle\": \"De Napoléon\",\n          \"readCount\": 3\n        },\n        ...\n      ]\n    },\n    {\n      \"ageGroup\": \"30-49\",\n      \"totalReadings\": 1519,\n      \"mostReadBooks\": [\n        {\n          \"bookId\": \"679cb338b477993c5cdcb595\",\n          \"bookTitle\": \"Riley Farm-Rhymes\",\n          \"readCount\": 2\n        },\n        ...\n      ]\n    },\n    {\n      \"ageGroup\": \"18-29\",\n      \"totalReadings\": 962,\n      \"mostReadBooks\": [\n        {\n          \"bookId\": \"679cb363b477993c5cde0fb0\",\n          \"bookTitle\": \"A vision of life\",\n          \"readCount\": 2\n        },\n        ...\n      ]\n    }\n  ],\n  \"message\": \"Statistics retrieved successfully\",\n  \"timestamp\": \"2025-02-09T17:41:05.8188524\",\n  \"status\": 200\n}\n"}}},"400":{"description":"Invalid date parameters","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"Please login to access this resource.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Insufficient privileges to access this resource.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}},"security":[{"bearerAuth":[]}]}},"/api/v1/admin/statistics/books-utilization":{"get":{"tags":["Usage statistics"],"summary":"(ADMIN) Get books utilization statistics","description":"Retrieves statistics on book utilization, including underutilized and overutilized books.","operationId":"getBooksUtilization","responses":{"200":{"description":"Statistics retrieved successfully","content":{"*/*":{"schema":{"$ref":"#/components/schemas/SuccessResponse"},"example":"{\n  \"data\": {\n    \"underutilized_books\": [\n      {\n        \"bookId\": \"679cb334b477993c5cdc8b4f\",\n        \"title\": \"Alice's Adventures in Wonderland\",\n        \"totalReadings\": 0,\n        \"totalCopies\": 13,\n        \"totalBranches\": 4,\n        \"avgCopiesPerBranch\": 3.25,\n        \"usageRatio\": 0\n      },\n      ...\n    ],\n    \"overutilized_books\": [\n      {\n        \"bookId\": \"679cb339b477993c5cdcbc25\",\n        \"title\": \"An Outback Marriage: A Story of Australian Life\",\n        \"totalReadings\": 5,\n        \"totalCopies\": 4,\n        \"totalBranches\": 4,\n        \"avgCopiesPerBranch\": 1,\n        \"usageRatio\": 1.25\n      },\n      ...\n    ]\n  },\n  \"message\": \"Statistics retrieved successfully\",\n  \"timestamp\": \"2025-02-09T17:43:08.6609359\",\n  \"status\": 200\n}\n"}}},"500":{"description":"Internal server error.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"Please login to access this resource.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Insufficient privileges to access this resource.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}},"security":[{"bearerAuth":[]}]}},"/api/v1/admin/statistics/average-age-readers":{"get":{"tags":["Usage statistics"],"summary":"(ADMIN) Get the average age of active readers by geographical area","description":"Retrieves the average age of active readers (who borrowed at least one book in the last year) grouped by city.","operationId":"getAverageAgeOfReadersByCity","responses":{"200":{"description":"Statistics retrieved successfully","content":{"*/*":{"schema":{"$ref":"#/components/schemas/SuccessResponse"},"example":{"data":{"Pisa":{"total_users":697,"average_age":59.76},"Livorno":{"total_users":98,"average_age":58.38},"Firenze":{"total_users":93,"average_age":56.98},"Lucca":{"total_users":100,"average_age":63.24}},"message":"Statistics retrieved successfully","timestamp":"2025-02-09T17:44:26.2491445","status":200}}}},"500":{"description":"Internal server error.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"Please login to access this resource.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Insufficient privileges to access this resource.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}},"security":[{"bearerAuth":[]}]}},"/api/v1/admin/loans/{libraryId}/reservations":{"get":{"tags":["Loans"],"summary":"(ADMIN) Get all reservations for a library","description":"Retrieves all active reservations for a specific library.","operationId":"getAllReservations","parameters":[{"name":"libraryId","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"401":{"description":"Unauthorized access.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Forbidden – insufficient permissions.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Library not found.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"Reservations retrieved successfully.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/SuccessResponse"},"example":"{\n  \"data\": {\n    \"reservations\": [\n      {\n        \"userId\": \"67a5269e68b78d7479d391a6\",\n        \"bookId\": \"679cb33db477993c5cdcdf9c\",\n        \"libraryId\": \"679cb364d125ba32463b9746\",\n        \"reservedAt\": \"2025-02-09T17:48:41.337\",\n        \"expiresAt\": \"2025-02-12T17:48:41.4001696\"\n      },\n      ...\n    ]\n  },\n  \"message\": \"Reservations retrieved successfully.\",\n  \"timestamp\": \"2025-02-09T17:49:31.2201696\",\n  \"status\": 200\n}\n"}}},"500":{"description":"Internal server error.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}},"security":[{"bearerAuth":[]}]}},"/api/v1/admin/loans/{libraryId}/overdue":{"get":{"tags":["Loans"],"summary":"(ADMIN) Retrieve overdue loans in a library","description":"Retrieves all overdue loans for a specific library.","operationId":"getOverdueLoans","parameters":[{"name":"libraryId","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"401":{"description":"Unauthorized access.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Forbidden – insufficient permissions.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Library not found.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"Overdue loans retrieved successfully.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/SuccessResponse"},"example":{"data":{"loans":[{"userId":"67a5269e68b78d7479d391a6","bookId":"679cb33db477993c5cdcdf9c","libraryId":"679cb364d125ba32463b9746","loanedAt":"2025-02-09T17:51:11.904","dueDate":"2025-03-11T17:51:11.9633414"}]},"message":"Loans retrieved successfully.","timestamp":"2025-02-09T17:51:41.6582558","status":200}}}},"500":{"description":"Internal server error.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}},"security":[{"bearerAuth":[]}]}},"/api/v1/admin/loans/{libraryId}/loans":{"get":{"tags":["Loans"],"summary":"(ADMIN) Get all loans for a library","description":"Retrieves all active loans for a specific library.","operationId":"getAllLoans","parameters":[{"name":"libraryId","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"401":{"description":"Unauthorized access.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Forbidden – insufficient permissions.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Library not found.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"Loans retrieved successfully.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/SuccessResponse"},"example":"{\n  \"data\": {\n    \"loans\": [\n      {\n        \"userId\": \"67a5269e68b78d7479d391a6\",\n        \"bookId\": \"679cb33db477993c5cdcdf9c\",\n        \"libraryId\": \"679cb364d125ba32463b9746\",\n        \"loanedAt\": \"2025-02-09T17:51:11.904\",\n        \"dueDate\": \"2025-03-11T17:51:11.9633414\"\n      },\n      ...\n    ]\n  },\n  \"message\": \"Loans retrieved successfully.\",\n  \"timestamp\": \"2025-02-09T17:51:41.6582558\",\n  \"status\": 200\n}\n"}}},"500":{"description":"Internal server error.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}},"security":[{"bearerAuth":[]}]}},"/api/v1/admin/loans/{id}/reserved-loaned":{"get":{"tags":["Loans"],"summary":"(ADMIN) Get reserved and loaned books","description":"Retrieves a list of books currently reserved or loaned by the specified user.","operationId":"getUserReservedAndLoanedBooks","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"404":{"description":"User not found","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"Unauthorized access – authentication required","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Forbidden – insufficient permissions","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"Successfully retrieved reserved and loaned books.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/SuccessResponse"},"example":{"data":{"reservedAndLoanedBooks":[{"bookId":"679cb34ab477993c5cdd4f0f","libraryId":"679cb364d125ba32463b9759","libraryName":"Biblioteca di Scienze naturali e ambientali dell'Università di Pisa","title":"Triplanetary","status":"RESERVED","deadlineDate":1739376697092}]},"message":"Reserved and loaned books retrieved successfully.","timestamp":"2025-02-09T17:12:57.9786811","status":200}}}},"500":{"description":"Internal server error","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}},"security":[{"bearerAuth":[]}]}},"/api/v1/admin/loans/{id}/details":{"get":{"tags":["Loans"],"summary":"(ADMIN) Get user details","description":"Retrieves the personal details of a user.","operationId":"getUserDetails_1","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Successfully retrieved user details.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/SuccessResponse"},"example":{"data":{"userDetails":{"id":"67a5269e68b78d7479d391a6","username":"john_doe","name":"John","surname":"Doe","dateOfBirth":"1990-01-01","email":"john.doe@example.com","address":{"street":"Via Roma, 10","city":"Firenze","province":"FI","postalCode":"50123","country":"Italy"}}},"message":"User details retrieved successfully.","timestamp":"2025-02-09T17:25:44.573562","status":200}}}},"404":{"description":"User not found","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"Unauthorized access – authentication required","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Forbidden – insufficient permissions","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}},"security":[{"bearerAuth":[]}]}},"/api/v1/reservations/{bookId}/{libraryId}":{"delete":{"tags":["Reservations"],"summary":"Cancel a book reservation","description":"Allows a user to cancel a book reservation.","operationId":"cancelReservation","parameters":[{"name":"bookId","in":"path","required":true,"schema":{"type":"string"}},{"name":"libraryId","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"404":{"description":"Reservation not found.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"Reservation cancelled successfully.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/SuccessResponse"}}}},"500":{"description":"Internal server error.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"Invalid reservation details.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"Please login to access this resource.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Insufficient privileges to access this resource.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}},"security":[{"bearerAuth":[]}]}},"/api/v1/reservations/unsave/{bookId}":{"delete":{"tags":["Reservations"],"summary":"Unsave a book","description":"Removes a saved book from the user's list.","operationId":"unsaveBook","parameters":[{"name":"bookId","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Book unsaved successfully.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/SuccessResponse"}}}},"404":{"description":"Book not found in saved list.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"Please login to access this resource.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Insufficient privileges to access this resource.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}},"security":[{"bearerAuth":[]}]}}},"components":{"schemas":{"SuccessResponse":{"type":"object","description":"Standard response format for successful operations (200 OK)","properties":{"timestamp":{"type":"string","format":"date-time","description":"Timestamp of the response","example":"2025-01-31T12:00:00.000Z"},"status":{"type":"integer","format":"int32","description":"HTTP status code","example":200},"message":{"type":"string","description":"Success message","example":"Request completed successfully"},"data":{"type":"object","description":"Response data (varies depending on the endpoint)"}}},"ErrorResponse":{"type":"object","description":"Standard error response format","properties":{"type":{"type":"string","description":"Type of error"},"title":{"type":"string","description":"Error title"},"status":{"type":"integer","format":"int32","description":"HTTP status code","example":"4xx, 5xx"},"detail":{"type":"string","description":"Error details"},"instance":{"type":"string","description":"Instance of the request that caused the error","example":"/api/v1/resource/{id}"},"timestamp":{"type":"integer","format":"int64","description":"Timestamp of the error occurrence","example":1738325243029},"error":{"type":"string","description":"Additional error information"}}},"CreatedResponse":{"type":"object","description":"Standard response format for successful resource creation (201 Created)","properties":{"timestamp":{"type":"string","format":"date-time","description":"Timestamp of the response","example":"2025-01-31T12:00:00.000Z"},"status":{"type":"integer","format":"int32","description":"HTTP status code","example":201},"message":{"type":"string","description":"Success message","example":"Resource created successfully"},"data":{"type":"object","description":"Created resource data"},"path":{"type":"string","description":"Path of the newly created resource","example":"/api/v1/resource/123"}}},"Address":{"type":"object","properties":{"street":{"type":"string","description":"Street name and house number.","example":"Via Roma, 10"},"city":{"type":"string","description":"City or comune of the address.","example":"Firenze"},"province":{"type":"string","description":"Province code (2 letters) of the address.","example":"FI"},"postalCode":{"type":"string","description":"Postal code (CAP) for the address.","example":50123},"country":{"type":"string","description":"Country of the address.","example":"Italy"}}},"RegistrationRequestDTO":{"type":"object","properties":{"username":{"type":"string","description":"Unique username for the user, must be 3-30 characters.","example":"john_doe","maxLength":30,"minLength":3},"password":{"type":"string","description":"Password for the user, must be 8-50 characters.","example":"P@ssword123","maxLength":50,"minLength":8},"email":{"type":"string","description":"User's email address.","example":"john.doe@example.com"},"address":{"$ref":"#/components/schemas/Address","description":"User's detailed address."},"name":{"type":"string","description":"User's first name, must be 2-50 characters.","example":"John","maxLength":50,"minLength":2},"surname":{"type":"string","description":"User's last name, must be 2-50 characters.","example":"Doe","maxLength":50,"minLength":2},"dateOfBirth":{"type":"string","format":"date","description":"User's date of birth, must be in the past.","example":"1990-01-01"}},"required":["dateOfBirth"]},"LoginRequestDTO":{"type":"object","properties":{"username":{"type":"string","description":"The username of the user attempting to log in.","example":"john_doe"},"password":{"type":"string","description":"The password of the user attempting to log in.","example":"secureP@ssw0rd123"}}},"LibraryDTO":{"type":"object","properties":{"id":{"type":"string","description":"The unique ID of the library.","example":"64b87f1a2d3b9c1234567890"},"name":{"type":"string","description":"The name of the library.","example":"Biblioteca degli Universitari Toscani"},"address":{"$ref":"#/components/schemas/Address","description":"The address of the library."},"district":{"type":"string","description":"The district where the library is located."},"postalCode":{"type":"string","description":"The postal code of the library's location.","example":12345},"province":{"type":"string","description":"The province where the library is located.","example":"Province A"},"region":{"type":"string","description":"The region where the library is located.","example":"Region B"},"provinceIstatCode":{"type":"string","description":"The ISTAT code of the province.","example":654321},"latitude":{"type":"number","format":"double","description":"The latitude coordinate of the library.","example":43.7942},"longitude":{"type":"number","format":"double","description":"The longitude coordinate of the library.","example":11.2468},"phone":{"type":"string","description":"The phone number of the library.","example":"123-456-7890"},"email":{"type":"string","description":"The email address of the library.","example":"info@library.com"},"url":{"type":"string","description":"The website or catalog URL of the library.","example":"http://library.com"}}},"BookDTO":{"type":"object","example":{"title":"The Revolutionary Ideas of Thomas Jefferson","subtitle":"A Perspective on Liberty","publicationDate":"2025-01-01","language":"English","categories":["History","Biography","Politics"],"isbn10":"1234567890","isbn13":"9781234567890","publisher":"Freedom Press","coverImageUrl":"https://example.com/cover.jpg","authors":[{"id":"6793b53c67e6767edfe2a3c9","fullName":"Thomas Jefferson"}]},"properties":{"id":{"type":"string","description":"The unique ID of the book.","example":"64b87f1a2d3b9c1234567890"},"title":{"type":"string","description":"The title of the book.","example":"Effective Java"},"subtitle":{"type":"string","description":"The subtitle of the book, if any.","example":"Programming Best Practices"},"publicationDate":{"type":"string","description":"The publication date of the book.","example":"2008-05-08"},"language":{"type":"string","description":"The language of the book.","example":"English"},"categories":{"type":"array","description":"The categories or genres of the book.","example":["Programming","Java"],"items":{"type":"string"}},"isbn10":{"type":"string","description":"The 10-digit ISBN of the book.","example":"0134685997"},"isbn13":{"type":"string","description":"The 13-digit ISBN of the book.","example":9780134685991},"publisher":{"type":"string","description":"The publisher of the book.","example":"Addison-Wesley"},"coverImageUrl":{"type":"string","description":"The URL of the book's cover image.","example":"https://example.com/effective-java.jpg"},"authors":{"type":"array","description":"A list of authors associated with the book.","items":{"$ref":"#/components/schemas/EmbeddedAuthor"}},"branches":{"type":"array","description":"A list of libraries where the book is available.","items":{"$ref":"#/components/schemas/EmbeddedLibraryDTO"}},"readingsCount":{"type":"integer","format":"int32","description":"The total number of times the book has been read.","example":120}}},"EmbeddedAuthor":{"type":"object","properties":{"id":{"$ref":"#/components/schemas/ObjectId"},"fullName":{"type":"string"}}},"EmbeddedLibraryDTO":{"type":"object","properties":{"id":{"type":"string","description":"The unique ID of the library.","example":"64b87f1a2d3b9c1234567890"},"libraryName":{"type":"string","description":"The name of the library.","example":"Central Library"},"coordinates":{"type":"array","description":"The geographical coordinates of the library.","example":[45.4642,9.19],"items":{"type":"number","format":"double"}},"address":{"type":"string","description":"The address of the library.","example":123},"numberOfCopies":{"type":"integer","format":"int32","description":"The number of copies available.","example":5}}},"ObjectId":{"type":"object","properties":{"timestamp":{"type":"integer","format":"int32"},"date":{"type":"string","format":"date-time"}}}},"securitySchemes":{"bearerAuth":{"type":"http","description":"Insert JWT token here","scheme":"bearer","bearerFormat":"JWT"}}}}